# 知涟 · WaitWiki  

> 等待，不是浪费，而是遇见知识的涟漪。  

**知涟 · WaitWiki** 是一个 Chrome 扩展插件，在 AI 对话等待期间展示有趣的知识卡片。  
每次按 Enter 键发送消息时，都会显示不同的知识内容，让等待变成发现。  

---

## 特性

- **RSS订阅**：自定义订阅RSS/Atom源，展示您关注的内容（默认启用）
- **自定义API**：支持添加自定义JSON API，灵活扩展内容源
- **智能更新**：每天8点和18点自动更新RSS/API内容，保持信息新鲜
- **订阅管理**：可视化管理RSS订阅和自定义API，支持启用/禁用/删除操作
- **智能切换**：每次按 Enter 键显示不同的知识卡片
- **智能分布**：确保不同来源的卡片都能均匀展示，避免重复
- **百科直链**：点击卡片标题即可跳转原文深入阅读  
- **简洁设计**：API卡片仅显示标题和链接，减少干扰
- **多源内容**：集成 RSS订阅、自定义API、Wikipedia、名言、趣闻等多种知识源
- **轻盈设计**：卡片风格简洁，支持淡入淡出动画，不干扰主要对话  
- **深色模式**：支持手动和自动深色模式切换
- **丰富配置**：卡片大小、展示时长、显示设置等可自定义
- **智能缓存**：300张卡片缓存池，优先使用缓存，减少API请求
- **多语言支持**：支持中英文等多语言维基内容

---

## 安装与使用

### Chrome 扩展安装
1. 下载或克隆本仓库
2. 打开 Chrome 浏览器
3. 进入 `扩展程序` 页面 (chrome://extensions/)
4. 打开 `开发者模式`
5. 点击 `加载已解压的扩展程序`
6. 选择 WaitWiki 文件夹

### 权限说明
本扩展需要以下权限：
- **activeTab**：仅在您激活标签页时访问当前页面，用于检测AI对话平台
- **storage**：保存您的设置和缓存数据，所有数据仅存储在本地
- **alarms**：用于定时更新RSS订阅和自定义API内容（每天8点和18点）
- **host_permissions**：访问公开的知识API和您订阅的RSS源

所有数据仅存储在您的浏览器本地，不会上传到任何服务器。RSS订阅列表存储在 chrome.storage.local 中，仅您可见。详细隐私政策请查看 [privacy.md](privacy.md)。

### 使用方法
1. 在支持的 AI 平台（ChatGPT、Claude、Gemini、Kimi 等）
2. 按 Enter 键发送消息时，WaitWiki 会自动显示知识卡片
3. 点击卡片链接可深入了解相关知识
4. 点击扩展图标可打开设置界面

### 支持的平台
- ChatGPT (chat.openai.com)
- Claude (claude.ai)
- Gemini (gemini.google.com)
- Kimi (kimi.ai, kimi.moonshot.cn)
- DeepSeek (chat.deepseek.com)
- Copilot (copilot.microsoft.com)
- Grok (grok.x.ai)
- 豆包 (doubao.com)
- 元宝 (yuanbao.tencent.com)

---

## 配置选项

### 基础设置
- **启用知涟**：开关插件功能
- **显示来源信息**：是否显示卡片来源
- **显示圆形图标**：是否显示右下角的圆形图标
- **暗夜模式**：手动切换深色模式

### 展示设置
- **展示时长**：10秒 / 20秒 / 常驻
- **卡片大小**：小 / 中 / 大

### 内容类型
- **RSS订阅**：您自定义的RSS/Atom订阅源（默认启用）
  - 支持添加任意RSS/Atom格式的订阅源
  - 每天自动更新（8点和18点）
  - 显示文章标题（可点击跳转）、摘要和来源
  - 可在popup面板管理订阅列表
- **自定义API**：支持添加自定义JSON API数据源
  - 支持任意符合格式的JSON API
  - 每天自动更新（8点和18点）
  - 简洁模式：仅显示标题和链接，减少干扰
  - 智能分布：确保不同来源的内容都能均匀展示
  - 可在popup面板管理API列表
- **维基百科**：随机百科知识
- **名言金句**：每日励志名言
- **数字趣闻**：数字趣闻和小知识
- **生活贴士**：实用生活建议
- **猫咪趣闻**：关于猫咪的有趣事实
- **知识问答**：趣味知识问答
- **经典调酒**：世界各地的经典鸡尾酒配方和制作方法
- **数据真相**：基于Factfulness理念的全球发展数据，展示世界如何变得更好（300条精选数据，涵盖全球性、区域性和权威机构数据）

---

## 技术架构

### 数据源
- **用户自定义RSS/Atom源**：您订阅的任意RSS/Atom格式内容（推荐使用）
- **用户自定义JSON API**：您配置的任意JSON格式API数据源
- **Wikipedia REST API**：随机摘要、每日精选、历史上的今天
- **Zen Quotes API**：励志名言
- **Quotable API**：备用名言源
- **Numbers API**：数字趣闻
- **Advice Slip API**：生活建议
- **Cat Facts API**：猫咪趣闻
- **The Trivia API**：知识问答
- **TheCocktailDB API**：鸡尾酒配方
- **Gapminder基金会**：全球发展数据（30%）
- **联合国及其专门机构**：权威统计数据（50%）
- **其他国际权威机构**：专业领域数据（18%）

### 核心技术
- **Chrome Extension API**：扩展程序框架
- **RESTful API**：数据获取
- **Local Storage**：本地缓存
- **CSS3 动画**：流畅的视觉效果
- **响应式设计**：适配各种屏幕尺寸

### 智能特性
- **防重复算法**：基于标题和内容相似度避免重复显示
- **智能分布**：按来源（source）均匀选择卡片，确保所有内容源都有机会展示
- **失败处理**：API失败时使用缓存，不会中断整个更新流程
- **缓存优先**：优先使用缓存，减少不必要的API请求
- **定时更新**：每天8点和18点自动更新，平时只使用缓存
- **缓存管理**：300张卡片缓存池，自动清理过期内容
- **预加载**：提前加载内容保证流畅体验

---

## 版本历史

### V1.4 (2025-01-XX)
- ✅ **新增自定义API功能**：支持添加自定义JSON API数据源
- ✅ **智能缓存机制**：优先使用缓存，每天8点和18点各请求一次
- ✅ **智能内容分布**：按来源均匀选择卡片，确保所有内容源都能展示
- ✅ **简洁API卡片**：API卡片仅显示标题和链接，减少干扰
- ✅ **可点击标题**：RSS和API卡片标题均可点击跳转原文
- ✅ **优化刷新机制**：修复刷新逻辑，确保所有源都能被处理
- ✅ **优化界面显示**：popup中URL和名称自动缩短，避免溢出
- ✅ **更新时间调整**：晚上更新时间从19点调整为18点

### V1.3 (2025-11-02)
- ✅ **新增RSS订阅功能**：支持自定义RSS/Atom订阅源
- ✅ **智能定时更新**：每天8点和18点自动更新RSS内容
- ✅ **RSS订阅管理**：可视化管理界面，支持增删改查
- ✅ **优化默认设置**：默认启用RSS订阅，其他内容类型可选
- ✅ **RSS内容展示**：标题超链接、摘要、来源信息完整展示
- ✅ **兼容多格式**：支持RSS 1.0/2.0和Atom格式

### V1.2 (2025-08-23)
- ✅ 新增4个API数据源（生活贴士、猫咪趣闻、知识问答、鸡尾酒谱）
- ✅ 添加内容类型控制面板，可单独开启/关闭各API
- ✅ 优化内容轮换算法，避免重复显示
- ✅ 增强安全性，防止XSS攻击
- ✅ 改进定时器管理，防止内存泄漏

### V1.1 (2025-08-23)
- ✅ 修复激活切换模式问题
- ✅ 实现每次Enter显示不同卡片
- ✅ 优化卡片选择算法
- ✅ 改进预加载机制

### V1.0 (2025-08-23)
- ✅ 完整的 WaitWiki 架构
- ✅ Wikipedia API 集成
- ✅ 名言 API 集成  
- ✅ 趣闻 API 集成
- ✅ 智能缓存机制
- ✅ 多语言支持
- ✅ 完整的配置系统
- ✅ 深色模式支持

---

## RSS订阅使用指南

### 如何添加RSS订阅

1. **点击扩展图标**打开设置面板
2. **找到"RSS订阅管理"**区域
3. **输入RSS地址**（支持RSS/Atom格式）
   - 示例：`https://sspai.com/feed`（少数派）
   - 示例：`https://www.zhihu.com/rss`（知乎）
   - 示例：`https://rsshub.app/sspai/series/41`（RSSHub）
4. **点击"➕ 添加"**按钮
5. 系统会自动验证RSS源并添加到列表

### 如何添加自定义API

1. **点击扩展图标**打开设置面板
2. **找到"自定义API管理"**区域
3. **输入API地址**（必须是JSON格式）
   - API应返回数组格式，每个元素包含：
     ```json
     {
       "status": "success",
       "id": "来源名称",
       "updatedTime": 时间戳,
       "items": [
         {
           "id": "唯一标识",
           "title": "标题",
           "url": "链接地址"
         }
       ]
     }
     ```
4. **点击"➕ 添加"**按钮
5. 系统会自动验证API并添加到列表

### 推荐RSS源

- **少数派**：`https://sspai.com/feed`
- **阮一峰的网络日志**：`https://www.ruanyifeng.com/blog/atom.xml`
- **知乎热榜**：`https://rsshub.app/zhihu/hotlist`
- **Hacker News**：`https://news.ycombinator.com/rss`
- **V2EX**：`https://www.v2ex.com/index.xml`
- **GitHub Trending**：`https://rsshub.app/github/trending/daily`

提示：可以使用 [RSSHub](https://docs.rsshub.app/) 订阅几乎任何网站的更新。

### 内容更新时间

- **RSS订阅**
  - **上午更新**：每天8:00或之后联网的第一次
  - **晚上更新**：每天18:00或之后联网的第一次
  - **手动更新**：添加新订阅时会立即更新内容
- **自定义API**
  - **上午更新**：每天8:00或之后联网的第一次
  - **晚上更新**：每天18:00或之后联网的第一次
  - **缓存优先**：平时只使用缓存，不主动请求API

### 管理订阅和API

- **启用/禁用**：点击订阅项/API项右侧的开关
- **删除**：点击订阅项/API项右侧的🗑️按钮
- **查看**：列表显示名称和URL（自动缩短显示，鼠标悬浮显示完整内容）

---

## 路线图

### V1.5 计划
- [ ] RSS文章分类标签
- [ ] RSS阅读标记（已读/未读）
- [ ] OPML导入/导出（批量管理订阅）
- [ ] 添加卡片收藏功能
- [ ] 优化移动端体验
- [ ] API数据统计和可视化

### 长期规划
- [ ] 多语言支持扩展
- [ ] RSS全文抓取
- [ ] 数据分析和统计
- [ ] 社区分享功能

---

## 贡献

欢迎提交 Issue 和 Pull Request，一起让"等待"更有趣。

### 开发环境
1. 克隆仓库
2. 修改代码后重新加载扩展
3. 查看控制台日志调试

---

## 许可证

- **代码**：MIT License
- **内容来源**：Wikipedia (CC BY-SA 3.0)
- **名言内容**：Zen Quotes API, Quotable API
- **请在产品中保留原始来源标注**

---

## 命名含义

- **中文**：知涟 —— 知识泛起的涟漪
- **英文**：WaitWiki —— 等待时的维基

---

## 联系方式

如有问题或建议，请通过以下方式联系：
- GitHub Issues
- 邮件：yourname@example.com

---

**让每一次等待都成为知识的发现之旅** 🌊
